<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Document</title>
    <link rel="stylesheet" type="text/css" href="main.css">
    <script src="./node_modules/web3/dist/web3.min.js" charset="utf-8"></script>
  </head>
  <body>
    <div class="container">
        <h1 class="title">Shubham</h1>
        <h2 id="instructor"></h2>
        <img id="loader" src="https://i.imgur.com/cp0U2Ut.gif">

        <label for="name" class="col-lg-2 control-label">Instructor Name</label>
        <input id="name" type="text">

        <label for="name" class="col-lg-2 control-label">Instructor Age</label>
        <input id="age" type="text">

        <button id="button">Update</button>
    </div>

    <script  src="https://code.jquery.com/jquery-3.4.0.slim.min.js"
        integrity="sha256-ZaXnYkHGqIhqTbJ6MB4l9Frs/r7U4jlx7ir8PJYBqbI="
        crossorigin="anonymous">
    </script>

    <script>
        if (typeof web3 !== 'undefined') {
          web3 = new Web3(web3.currentProvider);
        } else {
          web3 = new Web3(new Web3.providers.HttpProvider("http://localhost:8545"))
        }

        // default account, the first one in array
        web3.eth.defaultAccount = web3.eth.accounts[0];

        // Application Binary interface (ABI), allows you to call functions, recieve's data from your smartcontracts
        var shubhamContract = web3.eth.contract([{"constant":false,"inputs":[{"name":"_fName","type":"string"},{"name":"_age","type":"uint256"}],"name":"setInstructor","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"getInstructor","outputs":[{"name":"","type":"string"},{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"inputs":[],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"name":"name","type":"string"},{"indexed":false,"name":"age","type":"uint256"}],"name":"Instructor","type":"event"}]);
        // Contract address
        var Shubham = shubhamContract.at('0x8cac6a9907b142e7f7f04155625c6d047fe6d47a');
        console.log(Shubham);

        var instructorEvent = Shubham.Instructor();

        instructorEvent.watch(function(error, result) {
            if (!error) {
               $("#loader").hide();
               $("#instructor").html(result.args.name + ' (' + result.args.age + ' years old)');
            } else {
              $("#loader").hide();
              console.log("Error :", error);
            }
        }) 

        $("button").click(function() {
           Shubham.setInstructor($("#name").val(), $("#age").val(), (err, res) => {
              if (err) {
                $("#loader").hide();
                alert("Account not matched");
              }
           });
           $("#loader").show();
        });

    </script>

  </body>
</html>
